# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

## –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

–í —Ñ–∞–π–ª `web_ui/app.py` –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `./cache`.

### –ò–∑–º–µ–Ω–µ–Ω–∏—è

1. **–ò–º–ø–æ—Ä—Ç –º–æ–¥—É–ª–µ–π**:
   - –î–æ–±–∞–≤–ª–µ–Ω—ã `import os`, `import glob`, `import shutil` –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π.

2. **–°–µ–∫—Ü–∏—è "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º" –≤ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏**:
   - –ü–æ—Å–ª–µ —Ä–∞–∑–¥–µ–ª–∞ "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö" –∏ –ø–µ—Ä–µ–¥ —Ä–∞–∑–¥–µ–ª–æ–º "–ó–∞–ø—É—Å–∫" –¥–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫ "üóÉÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º".
   - –í–Ω—É—Ç—Ä–∏ —Å–µ–∫—Ü–∏–∏ —Ä–∞–∑–º–µ—â–µ–Ω—ã:
     - –ß–µ–∫–±–æ–∫—Å "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ—á–∏—Å—Ç–∫—É –∫—ç—à–∞" (`st.sidebar.checkbox`) –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è.
     - –ö–Ω–æ–ø–∫–∞ "üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –¥–∞–Ω–Ω—ã—Ö" —Å —Ç–∏–ø–æ–º `secondary` (—Å—Ç–∏–ª—å "danger" –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –Ω–æ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å).
     - –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞ (`disabled=not confirm_clear`), –ø–æ–∫–∞ —á–µ–∫–±–æ–∫—Å –Ω–µ –æ—Ç–º–µ—á–µ–Ω.
     - –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `.pkl` –≤–Ω—É—Ç—Ä–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `./cache`.
     - –í—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ—á–∏—Å—Ç–∫–µ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —É–¥–∞–ª—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (`st.sidebar.success`).
     - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å–ª—É—á–∞–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ñ–∞–π–ª–æ–≤ `.pkl`.
     - –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ.

3. **–õ–æ–≥–∏–∫–∞ –æ—á–∏—Å—Ç–∫–∏**:
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `glob.glob(os.path.join(cache_dir, "*.pkl"))` –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤.
   - –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª —É–¥–∞–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `os.remove()` —Å –ø–æ–¥—Å—á—ë—Ç–æ–º —É—Å–ø–µ—à–Ω—ã—Ö —É–¥–∞–ª–µ–Ω–∏–π.
   - –ï—Å–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤—ã–≤–æ–¥–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
   - –ï—Å–ª–∏ —á–µ–∫–±–æ–∫—Å –Ω–µ –æ—Ç–º–µ—á–µ–Ω, –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ.

### –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ (–¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π –±–ª–æ–∫)

```python
# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º
st.sidebar.subheader("üóÉÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º")
confirm_clear = st.sidebar.checkbox("–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ—á–∏—Å—Ç–∫—É –∫—ç—à–∞")
if st.sidebar.button("üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –¥–∞–Ω–Ω—ã—Ö", type="secondary", disabled=not confirm_clear):
    cache_dir = "./cache"
    if os.path.exists(cache_dir):
        pkl_files = glob.glob(os.path.join(cache_dir, "*.pkl"))
        deleted_count = 0
        for f in pkl_files:
            try:
                os.remove(f)
                deleted_count += 1
            except Exception as e:
                st.sidebar.error(f"–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è {f}: {e}")
        if deleted_count > 0:
            st.sidebar.success(f"–£–¥–∞–ª–µ–Ω–æ {deleted_count} —Ñ–∞–π–ª–æ–≤ –∫—ç—à–∞.")
        else:
            st.sidebar.info("–ù–µ—Ç —Ñ–∞–π–ª–æ–≤ .pkl –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è.")
    else:
        st.sidebar.info("–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∫—ç—à–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.")
if not confirm_clear:
    st.sidebar.warning("–î–ª—è –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞ –æ—Ç–º–µ—Ç—å—Ç–µ —á–µ–∫–±–æ–∫—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.")
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `./cache` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∞–π–ª—ã `.pkl` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `BTC_USDT_USDT_15m_20251117_20251217.pkl`).
- –û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –æ—Ç–º–µ—Ç—å—Ç–µ —á–µ–∫–±–æ–∫—Å –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –æ—á–∏—Å—Ç–∫–∏.
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã, –∞ –≤ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏ –ø–æ—è–≤–∏–ª–æ—Å—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ.
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ª—É—á–∞–π –ø—É—Å—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.

### –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –û—á–∏—Å—Ç–∫–∞ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã `.pkl` –≤–Ω—É—Ç—Ä–∏ `./cache`. –î—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `.json`, `.csv`) –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è.
- –ö—ç—à –≤ `session_state` (–≤ –ø–∞–º—è—Ç–∏) –Ω–µ –æ—á–∏—â–∞–µ—Ç—Å—è —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π, —Ç–∞–∫ –∫–∞–∫ –æ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö —Å–µ—Å—Å–∏–∏.
- –î–ª—è –ø–æ–ª–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ç–∞–∫–∂–µ —Å–±—Ä–æ—Å–∏—Ç—å `st.session_state.data_cache`, –Ω–æ —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞.

### –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `web_ui/app.py` ‚Äì –æ—Å–Ω–æ–≤–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ.
- `FIXES_CACHE_CLEANUP.md` ‚Äì —ç—Ç–æ—Ç —Ñ–∞–π–ª.

### –î–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è

2025-12-17