# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ–¥–∏–∞–Ω—ã –≤–º–µ—Å—Ç–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –¥–ª—è current_price

## –ü—Ä–æ–±–ª–µ–º–∞

–í `services/backtester.py` –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ `current_price` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å —Å—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ (`mean()`), —á—Ç–æ –¥–∞–≤–∞–ª–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –≤—ã–±—Ä–æ—Å–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö.

**–ü—Ä–∏–º–µ—Ä –∏–∑ –ª–æ–≥–æ–≤:**
```
–ì—Ä–∞–Ω–∏—Ü—ã —Å–µ—Ç–∫–∏: 80,000 - 100,000
Current price (mean): 114,908  ‚Üê –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!
–†–µ–∑—É–ª—å—Ç–∞—Ç: –í–°–ï 100 —É—Ä–æ–≤–Ω–µ–π < 114k ‚Üí –≤—Å–µ BUY, 0 SELL
```

–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ 114k –ø–æ–ª—É—á–∞–ª–∞—Å—å –∏–∑-–∑–∞ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Ü–µ–Ω—ã 424k –∏ –≤—ã—à–µ), –∫–æ—Ç–æ—Ä—ã–µ —Ç—è–Ω—É–ª–∏ —Å—Ä–µ–¥–Ω–µ–µ –≤–≤–µ—Ä—Ö, –¥–∞–∂–µ –ø–æ—Å–ª–µ —á–∞—Å—Ç–∏—á–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é —É—Ä–æ–≤–Ω–µ–π —Å–µ—Ç–∫–∏ (–≤—Å–µ —É—Ä–æ–≤–Ω–∏ –æ–∫–∞–∑—ã–≤–∞–ª–∏—Å—å –Ω–∏–∂–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã, —á—Ç–æ –æ–∑–Ω–∞—á–∞–ª–æ —Ç–æ–ª—å–∫–æ –ø–æ–∫—É–ø–∫–∏ –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–¥–∞–∂).

## –†–µ—à–µ–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–º–µ–¥–∏–∞–Ω—É** –≤–º–µ—Å—Ç–æ —Å—Ä–µ–¥–Ω–µ–≥–æ. –ú–µ–¥–∏–∞–Ω–∞ —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –≤—ã–±—Ä–æ—Å–∞–º –∏ –¥–∞—ë—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é "—Ç–∏–ø–∏—á–Ω—É—é" —Ü–µ–Ω—É –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å–µ—Ç–∫–∏.

## –í–Ω–µ—Å—ë–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—á—ë—Ç–∞ current_price –≤ backtester

**–§–∞–π–ª:** `services/backtester.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ó–∞–º–µ–Ω—ë–Ω `data["close"].mean()` –Ω–∞ `data["close"].median()`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: `logger.info(f"–ú–µ–¥–∏–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞ –¥–∞–Ω–Ω—ã—Ö: {avg_price:.2f}")`

**–ë—ã–ª–æ:**
```python
# –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç —É—Ä–æ–≤–Ω–µ–π —Å–µ—Ç–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã
avg_price = data["close"].mean()
strategy.calculate_levels(current_price=avg_price)
```

**–°—Ç–∞–ª–æ:**
```python
# –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç —É—Ä–æ–≤–Ω–µ–π —Å–µ—Ç–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ–¥–∏–∞–Ω–Ω–æ–π —Ü–µ–Ω—ã (—É—Å—Ç–æ–π—á–∏–≤–æ–π –∫ –≤—ã–±—Ä–æ—Å–∞–º)
avg_price = data["close"].median()
logger.info(f"–ú–µ–¥–∏–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞ –¥–∞–Ω–Ω—ã—Ö: {avg_price:.2f}")
strategy.calculate_levels(current_price=avg_price)
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—á—ë—Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

**–§–∞–π–ª:** `services/data_loader.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –í –º–µ—Ç–æ–¥ `get_data_statistics` –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è `median_price` –∏ `mean_price` –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ —Å–ª–æ–≤–∞—Ä—è
- –í–Ω—É—Ç—Ä–∏ `price_range` —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `median` –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

**–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:**
```python
stats = {
    "start_date": ...,
    "end_date": ...,
    "total_rows": ...,
    "columns": ...,
    "price_range": {
        "min": ...,
        "max": ...,
        "mean": ...,
        "median": ...,  # –¥–æ–±–∞–≤–ª–µ–Ω–æ
    },
    "volume_stats": {...},
    "missing_values": {...},
    "median_price": df["close"].median(),  # –¥–æ–±–∞–≤–ª–µ–Ω–æ
    "mean_price": df["close"].mean(),      # –¥–æ–±–∞–≤–ª–µ–Ω–æ
}
```

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–µ–¥–∏–∞–Ω—ã –≤ UI

**–§–∞–π–ª:** `web_ui/app.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –í –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏ "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö" –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç—Ä–æ–∫–∏:
  - **–ú–µ–¥–∏–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞**
  - **–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞**
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ —Å—Ä–µ–¥–Ω—è—è –∏ –º–µ–¥–∏–∞–Ω–∞ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 10% (–ø—Ä–∏–∑–Ω–∞–∫ –≤—ã–±—Ä–æ—Å–æ–≤)

**–ö–æ–¥:**
```python
# –î–æ–±–∞–≤–ª—è–µ–º –º–µ–¥–∏–∞–Ω—É –∏ —Å—Ä–µ–¥–Ω—é—é —Ü–µ–Ω—É
median_price = stats.get('median_price')
mean_price = stats.get('mean_price')
if median_price is not None and mean_price is not None:
    st.sidebar.write(f"**–ú–µ–¥–∏–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞:** {median_price:.2f}")
    st.sidebar.write(f"**–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞:** {mean_price:.2f}")
    
    # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - –ø–æ–∫–∞–∑–∞—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –µ—Å–ª–∏ –æ–Ω–∞ –±–æ–ª—å—à–∞—è
    if median_price != 0 and abs(mean_price - median_price) / median_price > 0.1:
        st.sidebar.warning("‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è –∏ –º–µ–¥–∏–∞–Ω–∞ —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è - –≤–æ–∑–º–æ–∂–Ω—ã –≤—ã–±—Ä–æ—Å—ã –≤ –¥–∞–Ω–Ω—ã—Ö")
```

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –í –ª–æ–≥–∞—Ö backtesting:
```
INFO:services.backtester:–ú–µ–¥–∏–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞ –¥–∞–Ω–Ω—ã—Ö: 88500.00
INFO:models.grid_strategy:–†–∞—Å—á—ë—Ç —É—Ä–æ–≤–Ω–µ–π —Å–µ—Ç–∫–∏: –≥—Ä–∞–Ω–∏—Ü—ã [80000.0, 100000.0], 
—É—Ä–æ–≤–Ω–µ–π 40, —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ 88500.00
```

### –í UI (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö):
```
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö
–ü–µ—Ä–∏–æ–¥: 2025-08-09 - 2025-12-17
–°—Ç—Ä–æ–∫: 5631
–î–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω—ã: 70000.00 - 100000.00
–ú–µ–¥–∏–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞: 88500.00
–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: 92300.00
```

### –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ backtesting:
- ‚úÖ –£—Ä–æ–≤–Ω–∏ –Ω–∏–∂–µ –º–µ–¥–∏–∞–Ω–Ω–æ–π —Ü–µ–Ω—ã ‚Üí BUY
- ‚úÖ –£—Ä–æ–≤–Ω–∏ –≤—ã—à–µ –º–µ–¥–∏–∞–Ω–Ω–æ–π —Ü–µ–Ω—ã ‚Üí SELL
- ‚úÖ –ü—Ä–∏–º–µ—Ä–Ω–æ 50% —É—Ä–æ–≤–Ω–µ–π BUY, 50% SELL (–ø—Ä–∏ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö –≥—Ä–∞–Ω–∏—Ü–∞—Ö)
- ‚úÖ –í trades.csv –±—É–¥—É—Ç –∏ –ø–æ–∫—É–ø–∫–∏, –∏ –ø—Ä–æ–¥–∞–∂–∏

## –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Streamlit:**
```bash
cd /mnt/e/Python_project/bybit_grid_bot && PYTHONPATH=$(pwd) streamlit run web_ui/app.py
```

2. **–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à** (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏):
```bash
rm cache/*.pkl
```

3. **–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ** (30-130 –¥–Ω–µ–π)

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É** - –¥–æ–ª–∂–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –º–µ–¥–∏–∞–Ω–∞ –∏ —Å—Ä–µ–¥–Ω—è—è

5. **–ó–∞–ø—É—Å—Ç–∏—Ç—å backtesting** - –≤ –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –º–µ–¥–∏–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞

6. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å trades.csv** - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏ buy, –∏ sell —Å–¥–µ–ª–∫–∏

## –ü–æ—á–µ–º—É –º–µ–¥–∏–∞–Ω–∞ –ª—É—á—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ?

- **–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –≤—ã–±—Ä–æ—Å–∞–º:** –ú–µ–¥–∏–∞–Ω–∞ –Ω–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –∫ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–æ—à–∏–±–∫–∏ API, –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ —Å–≤–µ—á–∏).
- **–†–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å:** –î–ª—è –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –º–µ–¥–∏–∞–Ω–∞ –ª—É—á—à–µ –æ—Ç—Ä–∞–∂–∞–µ—Ç "—Ç–∏–ø–∏—á–Ω–æ–µ" –∑–Ω–∞—á–µ–Ω–∏–µ.
- **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω–µ–π:** –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –º–µ–¥–∏–∞–Ω—ã —É—Ä–æ–≤–Ω–∏ —Å–µ—Ç–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≤–æ–∫—Ä—É–≥ —Ä–µ–∞–ª—å–Ω–æ–π —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –ø–æ–∫—É–ø–∫–∞–º–∏ –∏ –ø—Ä–æ–¥–∞–∂–∞–º–∏.

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ:
- `test_backtester.py` - 5 passed
- `test_grid_strategy.py` - 6 passed

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç `test_median.py` –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ:
- –í –ª–æ–≥–∞—Ö –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∑–∞–ø–∏—Å—å "–ú–µ–¥–∏–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞ –¥–∞–Ω–Ω—ã—Ö"
- –£—Ä–æ–≤–Ω–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –º–µ–∂–¥—É BUY –∏ SELL (5/5 –ø—Ä–∏ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö –≥—Ä–∞–Ω–∏—Ü–∞—Ö)
- –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –≤—ã–±—Ä–æ—Å–æ–≤ –º–µ–¥–∏–∞–Ω–∞ –æ—Å—Ç–∞—ë—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π, —Ç–æ–≥–¥–∞ –∫–∞–∫ —Å—Ä–µ–¥–Ω–µ–µ —Å–∏–ª—å–Ω–æ —Å–º–µ—â–∞–µ—Ç—Å—è

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ó–∞–º–µ–Ω–∞ —Å—Ä–µ–¥–Ω–µ–≥–æ –Ω–∞ –º–µ–¥–∏–∞–Ω—É —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —É—Ä–æ–≤–Ω–µ–π —Å–µ—Ç–∫–∏ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –≤—ã–±—Ä–æ—Å–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö. –¢–µ–ø–µ—Ä—å –±—ç–∫—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—ë—Ç –±–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –ø–æ–º–æ–≥–∞—é—â—É—é –≤—ã—è–≤–∏—Ç—å –∞–Ω–æ–º–∞–ª–∏–∏ –≤ –¥–∞–Ω–Ω—ã—Ö.